<!DOCTYPE html>
<html lang="es-AR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <title>OPEN BOX</title>
  <meta name="description" content="Funcional, CrossFit y Personalizado. Consultas por Instagram." />

  <meta property="og:title" content="OPEN BOX" />
  <meta property="og:description" content="Funcional, CrossFit y Personalizado. Consultas por Instagram." />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="https://iili.io/qHNHTOP.png" />
  <meta name="twitter:card" content="summary_large_image" />

  <link rel="icon" type="image/png" href="https://iili.io/qHNHTOP.png" />
  <meta name="theme-color" content="#0b0b0d" />

  <style>
    @font-face{
      font-family:"CFCrackedStone";
      src:
        url("./CFCrackedStone.ttf") format("truetype"),
        url("./fonts/CFCrackedStone.ttf") format("truetype");
      font-display:swap;
    }

    :root{
      --bg:#0b0b0d;
      --txt:rgba(255,255,255,0.92);
      --muted:rgba(255,255,255,0.70);
      --border:rgba(255,255,255,0.14);
      --accent:#7c5cff;
      --accent2:#20e3b2;
      --shadow:0 16px 40px rgba(0,0,0,0.45);
      --radius:18px;
      --maxw:1120px;
      --card:rgba(10,10,14,0.82);
    }

    *{box-sizing:border-box;}
    html,body{height:100%;}
    body{
      margin:0;
      font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Arial,"Noto Sans","Helvetica Neue",sans-serif;
      color:var(--txt);
      background:var(--bg);
      overflow-x:hidden;
      padding-bottom:46px;
    }

    /* Fondo overlay IMAGEN (global) */
    .bg-overlay{
      position:fixed;
      inset:0;
      background-image:url("https://iili.io/qHelxP1.jpg");
      background-size:cover;
      background-position:center;
      background-repeat:no-repeat;
      z-index:-3;
      transform:translateZ(0);
    }
    .bg-overlay::after{
      content:"";
      position:absolute;
      inset:0;
      background:
        radial-gradient(1200px 600px at 20% 0%, rgba(0,0,0,0.12), rgba(0,0,0,0.32)),
        linear-gradient(to bottom, rgba(0,0,0,0.18), rgba(0,0,0,0.34));
      z-index:-1;
    }

    a{color:inherit;text-decoration:none;}
    .wrap{width:min(var(--maxw),calc(100% - 32px));margin:0 auto;}

    .ob-font{
      font-family:"CFCrackedStone", ui-sans-serif, system-ui, sans-serif;
      text-transform:uppercase;
      letter-spacing:2px;
      color:#fff;
      text-shadow:0 18px 60px rgba(0,0,0,0.92);
    }

    .header{
      position:sticky;top:0;z-index:50;
      backdrop-filter:blur(10px);
      background:rgba(0,0,0,0.42);
      border-bottom:1px solid var(--border);
    }
    .header-inner{
      display:flex;align-items:center;justify-content:space-between;gap:14px;
      padding:12px 0;
    }

    .brand{display:flex;align-items:center;gap:12px;min-width:0;}
    .brand img{
      width:44px;height:44px;border-radius:12px;object-fit:cover;
      border:1px solid var(--border);box-shadow:var(--shadow);
      background:rgba(255,255,255,0.06);flex:0 0 auto;
    }
    .brand .txt{display:flex;flex-direction:column;line-height:1.05;min-width:0;}
    .brand .txt strong{
      font-size:14px;letter-spacing:0.6px;text-transform:uppercase;
      white-space:nowrap;overflow:hidden;text-overflow:ellipsis;
    }
    .brand .txt span{
      font-size:12px;color:var(--muted);
      white-space:nowrap;overflow:hidden;text-overflow:ellipsis;
    }

    .btn{
      display:inline-flex;align-items:center;justify-content:center;gap:10px;
      padding:10px 14px;border-radius:999px;border:1px solid var(--border);
      background:rgba(255,255,255,0.06);color:var(--txt);
      box-shadow:0 10px 26px rgba(0,0,0,0.35);
      transition:transform .15s ease, background .15s ease, border-color .15s ease;
      user-select:none;cursor:pointer;white-space:nowrap;
    }
    .btn:hover{transform:translateY(-1px);background:rgba(255,255,255,0.10);border-color:rgba(255,255,255,0.18);}
    .btn-primary{
      background:linear-gradient(135deg, rgba(124,92,255,0.95), rgba(32,227,178,0.85));
      border-color:rgba(255,255,255,0.20);
      color:#0b0b0d;font-weight:800;
    }
    .btn-primary:hover{background:linear-gradient(135deg, rgba(124,92,255,1), rgba(32,227,178,0.95));}

    main{padding:26px 0 0;}
    section{padding:30px 0;}
    .grid{display:grid;gap:28px;}

    .card{
      background:var(--card);
      border:1px solid var(--border);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      overflow:hidden;
    }
    .card-pad{padding:18px;}

    .kicker{
      display:inline-flex;align-items:center;gap:8px;
      padding:6px 10px;border-radius:999px;border:1px solid rgba(255,255,255,0.22);
      background:rgba(0,0,0,0.42);
      color:#ffffff;
      font-size:12px;letter-spacing:0.4px;text-transform:uppercase;
    }

    .hero{display:grid;gap:22px;align-items:stretch;grid-template-columns:1.15fr 0.85fr;}
    .hero-left{
      position:relative;
      min-height:520px;
      border-radius:calc(var(--radius) + 4px);
      overflow:hidden;
      border:1px solid var(--border);
      box-shadow:var(--shadow);
      background:#000;
    }

    /* HERO VIDEO */
    .hero-video{
      position:absolute;inset:0;
      width:100%;height:100%;
      object-fit:cover;
      display:block;
      opacity:0.92;
    }
    .hero-left::after{
      content:"";
      position:absolute;inset:0;pointer-events:none;
      background:
        radial-gradient(900px 420px at 25% 20%, rgba(0,0,0,0.08), rgba(0,0,0,0.30)),
        linear-gradient(to bottom, rgba(0,0,0,0.16), rgba(0,0,0,0.34));
    }

    .hero-content{
      position:relative;z-index:2;height:100%;
      display:flex;flex-direction:column;justify-content:flex-end;
      padding:22px;padding-bottom:32px;
    }
    .hero-panel{
      width:min(760px, 100%);
      border-radius:18px;
      padding:18px 18px;
      background:rgba(0,0,0,0.60);
      border:1px solid rgba(255,255,255,0.16);
      box-shadow:0 18px 44px rgba(0,0,0,0.45);
      backdrop-filter: blur(6px);
    }
    .hero-brand{
      font-size:clamp(44px,6vw,84px);
      line-height:0.95;
      margin:10px 0 6px;
    }
    .hero-title{
      font-size:clamp(18px,2.2vw,26px);
      margin:6px 0 0;
      letter-spacing:-0.3px;
      color:#ffffff;
      text-shadow:0 14px 36px rgba(0,0,0,0.86);
    }
    .hero-sub{
      margin:10px 0 0;
      color:#ffffff;
      font-size:14px;line-height:1.55;
      max-width:58ch;
      text-shadow:0 14px 36px rgba(0,0,0,0.86);
    }
    .hero-cta{display:flex;flex-wrap:wrap;gap:12px;margin-top:14px;}

    .side{display:grid;gap:28px;height:100%;}
    .side .card{height:100%;}

    .list{margin:12px 0 0;padding:0;list-style:none;display:grid;gap:12px;}
    .li{
      display:flex;gap:10px;align-items:flex-start;
      padding:12px 12px;border-radius:14px;
      background:rgba(255,255,255,0.06);
      border:1px solid rgba(255,255,255,0.10);
    }
    .dot{
      width:10px;height:10px;border-radius:999px;margin-top:5px;
      background:linear-gradient(135deg,var(--accent),var(--accent2));
      flex:0 0 auto;
    }
    .li strong{display:block;font-size:13px;letter-spacing:0.2px;margin-bottom:2px;color:#fff;}
    .li span{display:block;font-size:12px;color:var(--muted);line-height:1.35;}

    .cards-3{grid-template-columns:repeat(3,minmax(0,1fr));gap:28px;}
    .cards-2{grid-template-columns:repeat(2,minmax(0,1fr));gap:28px;}
    .h2{margin:0 0 12px;font-size:18px;letter-spacing:-0.2px;color:#fff;}
    .p{margin:0;color:rgba(255,255,255,0.78);font-size:13px;line-height:1.6;}

    .svc-img{
      width:100%;
      height:220px;
      object-fit:cover;
      display:block;
      background:#000;
      border-bottom:1px solid rgba(255,255,255,0.10);
    }
    .svc-badge{
      display:inline-flex;align-items:center;gap:8px;
      margin-top:10px;
      padding:6px 10px;border-radius:999px;
      border:1px solid rgba(255,255,255,0.18);
      background:rgba(0,0,0,0.38);
      color:rgba(255,255,255,0.92);
      font-size:12px;text-transform:uppercase;letter-spacing:0.4px;
    }

    .map{
      border-radius:calc(var(--radius) + 2px);
      overflow:hidden;border:1px solid var(--border);box-shadow:var(--shadow);
      background:rgba(255,255,255,0.04);margin-top:14px;
    }
    .map iframe{width:100%;height:250px;border:0;display:block;}

    /* Carrusel grande (fotos + videos) */
    .carousel{
      position:relative;
      border-radius:calc(var(--radius) + 4px);
      overflow:hidden;
      border:1px solid rgba(255,255,255,0.14);
      box-shadow:0 18px 44px rgba(0,0,0,0.40);
      background:rgba(0,0,0,0.70);
      margin-top:12px;
    }
    .track{
      display:flex;
      transition:transform .55s ease;
      will-change:transform;
    }
    .slide{
      min-width:100%;
      height:420px;
      position:relative;
      background:#000;
      display:flex;
      align-items:center;
      justify-content:center;
    }
    .slide img{
      width:100%;
      height:100%;
      object-fit:cover;
      display:block;
    }
    .slide video{
      width:100%;
      height:100%;
      object-fit:cover;
      display:block;
      background:#000;
    }

    .car-ui{
      position:absolute;
      left:14px;right:14px;bottom:14px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      pointer-events:none;
    }
    .car-btn{
      pointer-events:auto;
      width:44px;height:44px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,0.18);
      background:rgba(0,0,0,0.55);
      backdrop-filter:blur(8px);
      display:grid;place-items:center;
      cursor:pointer;
      color:#fff;
      transition:transform .12s ease, background .12s ease;
    }
    .car-btn:hover{transform:translateY(-1px);background:rgba(0,0,0,0.72);}

    .dots{
      pointer-events:auto;
      display:flex;
      gap:8px;
      align-items:center;
      justify-content:center;
      flex:1;
    }
    .dotb{
      width:9px;height:9px;border-radius:999px;
      border:1px solid rgba(255,255,255,0.20);
      background:rgba(255,255,255,0.14);
      cursor:pointer;
    }
    .dotb.is-active{
      background:linear-gradient(135deg, rgba(124,92,255,0.95), rgba(32,227,178,0.85));
      border-color:rgba(255,255,255,0.22);
    }

    footer{
      padding:26px 0 38px;border-top:1px solid var(--border);
      background:rgba(0,0,0,0.30);margin-top:18px;
    }
    .footer-inner{
      display:flex;align-items:center;justify-content:space-between;gap:12px;flex-wrap:wrap;
      color:var(--muted);font-size:12px;
    }
    .footer-inner a{
      color:rgba(255,255,255,0.90);
      border-bottom:1px dashed rgba(255,255,255,0.30);
    }

    .float-ig{
      position: fixed;right:16px;bottom:16px;z-index:60;
      display:inline-flex;align-items:center;gap:10px;
      padding:12px 14px;border-radius:999px;
      border:1px solid rgba(255,255,255,0.18);
      background:rgba(0,0,0,0.62);
      backdrop-filter:blur(10px);
      box-shadow:0 18px 44px rgba(0,0,0,0.45);
      color:rgba(255,255,255,0.92);
      max-width:calc(100vw - 32px);
      transition:opacity .15s ease, transform .15s ease;
    }
    .float-ig.is-hidden{opacity:0;transform:translateY(12px);pointer-events:none;}
    .ig-badge{
      width:34px;height:34px;border-radius:10px;display:grid;place-items:center;
      background:linear-gradient(135deg, rgba(245,133,41,0.95), rgba(221,42,123,0.9), rgba(129,52,175,0.9), rgba(81,91,212,0.9));
      border:1px solid rgba(255,255,255,0.18);
      flex:0 0 auto;
    }
    .ig-badge svg{width:18px;height:18px;}
    .float-ig .t{display:flex;flex-direction:column;line-height:1.05;min-width:0;}
    .float-ig .t strong{font-size:13px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}
    .float-ig .t span{font-size:12px;color:rgba(255,255,255,0.78);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}

    @media (max-width: 920px){
      main{padding-top:22px;}
      section{padding:26px 0;}
      .hero{grid-template-columns:1fr;}
      .hero-left{min-height:620px;}
      .hero-left::after{
        background:linear-gradient(to bottom, rgba(0,0,0,0.10), rgba(0,0,0,0.26));
      }
      .hero-panel{
        background:rgba(0,0,0,0.50) !important;
        border:1px solid rgba(255,255,255,0.16) !important;
        box-shadow:0 18px 44px rgba(0,0,0,0.40) !important;
        backdrop-filter: blur(6px) !important;
        padding:16px !important;
      }
      .cards-3{grid-template-columns:1fr;}
      .cards-2{grid-template-columns:1fr;}
      .svc-img{height:210px;}
      .hero-content{justify-content:flex-end;padding-bottom:22px;}
      .map iframe{height:240px;}
      .slide{height:360px;}
    }

    @media (max-width: 520px){
      .slide{height:320px;}
    }

    @media (max-width: 420px){
      .brand img{width:40px;height:40px;}
      .btn{padding:10px 12px;}
      .float-ig{right:12px;bottom:12px;}
    }
  </style>
</head>

<body>
  <div class="bg-overlay" aria-hidden="true"></div>

  <header class="header">
    <div class="wrap header-inner">
      <a class="brand" href="#inicio" aria-label="Ir al inicio">
        <img src="https://iili.io/qHNHTOP.png" alt="Open Box logo" />
        <div class="txt">
          <strong><span class="ob-font">OPEN BOX</span></strong>
          <span>Entrenamiento</span>
        </div>
      </a>

      <a class="btn btn-primary" href="https://www.instagram.com/gimnasio.openbox/" target="_blank" rel="noopener">
        Ver Instagram
      </a>
    </div>
  </header>

  <main class="wrap" id="inicio">
    <section>
      <div class="hero">
        <div class="hero-left" aria-label="Hero">
          <video class="hero-video" autoplay loop muted playsinline preload="metadata" poster="https://iili.io/qHOTGgp.png">
            <source src="https://uzurdpsiniidxrbpqbtv.supabase.co/storage/v1/object/public/Videos%20gym/VID-20260214-WA0000%281%29.mp4" type="video/mp4" />
          </video>

          <div class="hero-content">
            <div class="hero-panel">
              <span class="kicker">Funcional · CrossFit · Personalizado</span>

              <div class="hero-brand ob-font">OPEN BOX</div>

              <div class="hero-title">Entrenamientos guiados</div>

              <p class="hero-sub">
                Clases y rutinas por nivel. Te ubicamos segun tu objetivo para sostener el plan y avanzar.
              </p>

              <div class="hero-cta">
                <a class="btn btn-primary" href="https://www.instagram.com/gimnasio.openbox/" target="_blank" rel="noopener">Consultar por Instagram</a>
                <a class="btn" href="#galeria">Ver galeria</a>
              </div>
            </div>
          </div>
        </div>

        <div class="side">
          <div class="card">
            <div class="card-pad">
              <h2 class="h2">Como se trabaja</h2>
              <p class="p">Una estructura simple para que arranques, mejores y no abandones.</p>
              <ul class="list">
                <li class="li"><span class="dot"></span><div><strong>Clases guiadas</strong><span>Tecnica y progresiones sin improvisar.</span></div></li>
                <li class="li"><span class="dot"></span><div><strong>Plan segun objetivo</strong><span>Fuerza, rendimiento o recomposicion.</span></div></li>
                <li class="li"><span class="dot"></span><div><strong>Seguimiento</strong><span>Para sostener constancia semana a semana.</span></div></li>
              </ul>
            </div>
          </div>

          <div class="card">
            <div class="card-pad">
              <h2 class="h2">Metodo</h2>
              <ul class="list">
                <li class="li"><span class="dot"></span><div><strong>1) Evaluacion</strong><span>Nivel + objetivo</span></div></li>
                <li class="li"><span class="dot"></span><div><strong>2) Ubicacion</strong><span>Turno + rutina</span></div></li>
                <li class="li"><span class="dot"></span><div><strong>3) Progresion</strong><span>Paso a paso</span></div></li>
                <li class="li"><span class="dot"></span><div><strong>4) Ajustes</strong><span>Seguimiento</span></div></li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section id="servicios">
      <div class="grid cards-3">
        <div class="card">
          <img class="svc-img" src="https://iili.io/qJnX3Bt.webp" alt="Funcional" />
          <div class="card-pad">
            <span class="svc-badge">Servicio</span>
            <h2 class="h2" style="margin-top:10px;">Funcional</h2>
            <p class="p">Fuerza, resistencia y movilidad. Ideal para empezar y mejorar el estado fisico general.</p>
          </div>
        </div>

        <div class="card">
          <img class="svc-img" src="https://iili.io/qJnw73X.webp" alt="CrossFit" />
          <div class="card-pad">
            <span class="svc-badge">Servicio</span>
            <h2 class="h2" style="margin-top:10px;">CrossFit</h2>
            <p class="p">WODs con tecnica y progresiones por nivel. Intensidad bien guiada y controlada.</p>
          </div>
        </div>

        <div class="card">
          <img class="svc-img" src="https://iili.io/qJnkDen.webp" alt="Personalizado" />
          <div class="card-pad">
            <span class="svc-badge">Servicio</span>
            <h2 class="h2" style="margin-top:10px;">Personalizado</h2>
            <p class="p">Plan a medida segun tu objetivo. Acompañamiento y ajustes para avanzar de verdad.</p>
          </div>
        </div>
      </div>
    </section>

    <section id="galeria">
      <div class="grid cards-2">
        <div class="card">
          <div class="card-pad">
            <span class="kicker">Ubicacion</span>
            <div class="map" aria-label="Mapa">
              <iframe
                loading="lazy"
                referrerpolicy="no-referrer-when-downgrade"
                src="https://www.google.com/maps?q=Av.%20Agustin%20Alvarez%2025%2C%209%20de%20Julio%2C%20Buenos%20Aires&output=embed"
                title="Mapa">
              </iframe>
            </div>
            <div style="margin-top:14px;">
              <a class="btn btn-primary" href="https://www.instagram.com/gimnasio.openbox/" target="_blank" rel="noopener">Consultar por Instagram</a>
            </div>
          </div>
        </div>

        <div class="card">
          <div class="card-pad">
            <span class="kicker">Galeria</span>
            <h2 class="h2" style="margin-top:10px;">Fotos y videos</h2>
            <p class="p">Carrusel grande automatico. Fotos y videos en una sola pasada.</p>

            <div class="carousel" id="carousel">
              <div class="track" id="track">
                <!-- FOTO HERO ANTERIOR pasa a galeria -->
                <div class="slide"><img src="https://iili.io/qHOTGgp.png" alt="Foto 0" /></div>

                <!-- FOTOS -->
                <div class="slide"><img src="https://iili.io/qJKxm5N.jpg" alt="Foto 1" /></div>
                <div class="slide"><img src="https://iili.io/qJKzHzX.jpg" alt="Foto 2" /></div>
                <div class="slide"><img src="https://iili.io/qJKxybt.jpg" alt="Foto 3" /></div>
                <div class="slide"><img src="https://iili.io/qJKxpeI.jpg" alt="Foto 4" /></div>
                <div class="slide"><img src="https://iili.io/qJKzF1f.jpg" alt="Foto 5" /></div>
                <div class="slide"><img src="https://iili.io/qJKz3qG.jpg" alt="Foto 6" /></div>
                <div class="slide"><img src="https://iili.io/qJKzKg4.jpg" alt="Foto 7" /></div>

                <!-- VIDEOS -->
                <div class="slide">
                  <video muted playsinline preload="metadata" poster="https://iili.io/qHOTGgp.png">
                    <source src="https://uzurdpsiniidxrbpqbtv.supabase.co/storage/v1/object/public/Videos%20gym/VID-20260214-WA0000%281%29.mp4" type="video/mp4" />
                  </video>
                </div>
                <div class="slide">
                  <video muted playsinline preload="metadata" poster="https://iili.io/qHOTGgp.png">
                    <source src="https://uzurdpsiniidxrbpqbtv.supabase.co/storage/v1/object/public/Videos%20gym/VID-20260214-WA0002.mp4" type="video/mp4" />
                  </video>
                </div>
              </div>

              <div class="car-ui">
                <button class="car-btn" type="button" id="prev" aria-label="Anterior">
                  <svg viewBox="0 0 24 24" width="18" height="18" fill="none">
                    <path d="M15 6l-6 6 6 6" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                </button>

                <div class="dots" id="dots"></div>

                <button class="car-btn" type="button" id="next" aria-label="Siguiente">
                  <svg viewBox="0 0 24 24" width="18" height="18" fill="none">
                    <path d="M9 6l6 6-6 6" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                </button>
              </div>
            </div>

            <div style="margin-top:14px;">
              <a class="btn" href="#inicio">Volver arriba</a>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <footer id="footer">
    <div class="wrap footer-inner">
      <div>© <span id="y"></span> <span class="ob-font">OPEN BOX</span></div>
      <div>
        <a href="https://www.instagram.com/gimnasio.openbox/" target="_blank" rel="noopener">Instagram</a>
        &nbsp;·&nbsp;
        <a href="https://ciborg347.onrender.com" target="_blank" rel="noopener">Creado y diseñado por Ciborg 347</a>
      </div>
    </div>
  </footer>

  <a class="float-ig" id="floatIg" href="https://www.instagram.com/gimnasio.openbox/" target="_blank" rel="noopener" aria-label="Abrir Instagram">
    <span class="ig-badge" aria-hidden="true">
      <svg viewBox="0 0 24 24" fill="none">
        <path d="M7.5 2.8h9A4.7 4.7 0 0 1 21.2 7.5v9A4.7 4.7 0 0 1 16.5 21.2h-9A4.7 4.7 0 0 1 2.8 16.5v-9A4.7 4.7 0 0 1 7.5 2.8Z" stroke="white" stroke-width="1.6"/>
        <path d="M12 16.2A4.2 4.2 0 1 0 12 7.8a4.2 4.2 0 0 0 0 8.4Z" stroke="white" stroke-width="1.6"/>
        <path d="M17.3 6.7h.01" stroke="white" stroke-width="3" stroke-linecap="round"/>
      </svg>
    </span>
    <span class="t">
      <strong>@gimnasio.openbox</strong>
      <span>Consultar</span>
    </span>
  </a>

  <script>
    document.getElementById("y").textContent = new Date().getFullYear();

    (function(){
      var footer = document.getElementById("footer");
      var floatIg = document.getElementById("floatIg");
      if(!footer || !floatIg) return;

      var io = new IntersectionObserver(function(entries){
        entries.forEach(function(e){
          if(e.isIntersecting) floatIg.classList.add("is-hidden");
          else floatIg.classList.remove("is-hidden");
        });
      }, { root: null, threshold: 0.01 });

      io.observe(footer);
    })();

    (function(){
      var carousel = document.getElementById("carousel");
      var track = document.getElementById("track");
      var prev = document.getElementById("prev");
      var next = document.getElementById("next");
      var dotsWrap = document.getElementById("dots");
      var slides = Array.prototype.slice.call(track.children);
      var idx = 0;
      var timer = null;
      var delay = 3600;

      function setTransform(){
        track.style.transform = "translateX(" + (-idx * 100) + "%)";
        updateDots();
        handleSlideMedia();
      }

      function buildDots(){
        dotsWrap.innerHTML = "";
        slides.forEach(function(_, i){
          var b = document.createElement("button");
          b.type = "button";
          b.className = "dotb" + (i === idx ? " is-active" : "");
          b.addEventListener("click", function(){
            idx = i;
            setTransform();
            restart();
          });
          dotsWrap.appendChild(b);
        });
      }

      function updateDots(){
        var dots = dotsWrap.querySelectorAll(".dotb");
        dots.forEach(function(d, i){
          d.classList.toggle("is-active", i === idx);
        });
      }

      function nextSlide(){
        idx = (idx + 1) % slides.length;
        setTransform();
      }

      function prevSlide(){
        idx = (idx - 1 + slides.length) % slides.length;
        setTransform();
      }

      function stopAllVideos(){
        slides.forEach(function(s){
          var v = s.querySelector("video");
          if(v){
            v.pause();
            v.currentTime = 0;
          }
        });
      }

      function handleSlideMedia(){
        stopAllVideos();
        var current = slides[idx];
        var v = current.querySelector("video");
        if(v){
          v.muted = true;
          v.play().catch(function(){});
        }
      }

      function start(){
        if(timer) return;
        timer = setInterval(nextSlide, delay);
      }

      function stop(){
        if(!timer) return;
        clearInterval(timer);
        timer = null;
      }

      function restart(){
        stop();
        start();
      }

      prev.addEventListener("click", function(){
        prevSlide();
        restart();
      });
      next.addEventListener("click", function(){
        nextSlide();
        restart();
      });

      carousel.addEventListener("mouseenter", stop);
      carousel.addEventListener("mouseleave", start);
      carousel.addEventListener("touchstart", stop, {passive:true});
      carousel.addEventListener("touchend", start, {passive:true});

      buildDots();
      setTransform();
      start();
    })();
  </script>
</body>
</html>
